
import tensorflow as tf
from keras import layers
import matplotlib.pyplot as plt
import numpy as np


# def plota_historico_modelo(history):
#     fig, axs = plt.subplot(1, 2, figsize=(15, 5))
#
#     axs[0].plot(range(1, history['accuracy'] + 1), history['accuracy'], 'r')
#     axs[0].plot(range(1, history['val_accuracy'] + 1), history['val_accuracy'], 'b')
#     axs[0].set_title("Acuracia do modelo")
#     axs[0].set_ylabel("Acuracia")
#     axs[0].set_xlabel("Epoch")
#     axs[0].set_xticks(np.arange(1, len(history['accuracy'] + 1),
#                                 len(history['accuracy']) / 10))
#     axs[0].legend(['traning accuracy', 'validation accuracy'], loc='best')
#     # loss
#     axs[1].plot(range(1, history['loss'] + 1), history['loss'], 'r')
#     axs[1].plot(range(1, history['val_loss'] + 1), history['val_loss'], 'b')
#     axs[1].set_title("Acuracia do modelo")
#     axs[1].set_ylabel("Acuracia")
#     axs[1].set_xlabel("Epoch")
#     axs[1].set_xticks(np.arange(1, len(history['accuracy'] + 1),
#                                 len(history['accuracy']) / 10))
#     axs[0].legend(['traning loss', 'validation loss'], loc='best')
#
#     fig.salve('historico_modelo_mod01.png')
#     plota_historico_modelo(history)
def plota_historico_modelo(history):
  fig, axs = plt.subplots(1, 2, figsize=(20,10))
  axs[0].plot(range(1, len(  history['accuracy']) + 1),  history['accuracy'], 'r')
  axs[0].plot(range(1, len(  history['val_accuracy']) + 1), history['val_accuracy'], 'b')
  axs[0].set_title('Acurácia do modelo')
  axs[0].set_ylabel('Acurácia')
  axs[0].set_xlabel('Epoch')
  axs[0].set_xticks(np.arange(1, len(history['accuracy']) + 1) )
  axs[0].legend(['training accuracy', 'validation accuracy'], loc = 'best')

  axs[1].plot(range(1, len(history['loss']) + 1), history['loss'], 'r')
  axs[1].plot(range(1, len(history['val_loss']) + 1), history['val_loss'], 'b')
  axs[1].set_title('Loss do modelo')
  axs[1].set_ylabel('Loss')
  axs[1].set_xlabel('Epoch')
  axs[1].set_xticks(np.arange(1, len(history['loss']) + 1) )

  axs[1].legend(['training loss', 'validation loss'], loc = 'best')
  fig.savefig('historico_modelo_mod02.png')



history = {'loss': [1.9978095293045044, 1.8361477851867676, 1.8178751468658447, 1.7654327154159546, 1.6434540748596191,
                    1.5431935787200928, 1.459386944770813, 1.420246958732605, 1.3740195035934448, 1.3419486284255981,
                    1.3183748722076416, 1.2808263301849365, 1.2582457065582275, 1.233576774597168, 1.2095754146575928,
                    1.1872764825820923, 1.1657071113586426, 1.1430734395980835, 1.1276681423187256, 1.1066588163375854,
                    1.0800870656967163, 1.0602482557296753, 1.0486606359481812, 1.025742530822754, 0.9979644417762756,
                    0.9821932315826416, 0.9608235359191895, 0.9454323649406433, 0.9223992824554443, 0.9062259197235107,
                    0.8836742043495178, 0.86374831199646, 0.8384454250335693, 0.8219107985496521, 0.8142707943916321,
                    0.8073382377624512, 0.7829153537750244, 0.7541009783744812, 0.7348753213882446, 0.7332670092582703,
                    0.7138271927833557, 0.6856657862663269, 0.6706728935241699, 0.6508883237838745, 0.6418285369873047,
                    0.6213681697845459],
           'accuracy': [0.21284574270248413, 0.24050502479076385, 0.24772946536540985, 0.2813059091567993,
                        0.3469451069831848, 0.3939383625984192, 0.4317118525505066, 0.45273151993751526,
                        0.4746800661087036, 0.49415165185928345, 0.5018576979637146, 0.5185083150863647,
                        0.5296890139579773, 0.5418673157691956, 0.5511215329170227, 0.5614765286445618,
                        0.5705586671829224, 0.5805696845054626, 0.5871748924255371, 0.5963258743286133,
                        0.6039287447929382, 0.6091234087944031, 0.6209921836853027, 0.6283541917800903,
                        0.6355786323547363, 0.6472065448760986, 0.6535709500312805, 0.6587656736373901,
                        0.6660245060920715, 0.6754162907600403, 0.6826751232147217, 0.6861497163772583,
                        0.6967799663543701, 0.7043828368186951, 0.7063437700271606, 0.7111256122589111,
                        0.7189692854881287, 0.7298059463500977, 0.7364455461502075, 0.7381312847137451,
                        0.7459749579429626, 0.7584629058837891, 0.7639328241348267, 0.7706068754196167,
                        0.7722925543785095, 0.7814435362815857],
           'val_loss': [1.8293901681900024, 1.8004754781723022, 1.8200898170471191, 1.6991387605667114,
                        1.727225422859192, 1.4683256149291992, 1.3941901922225952, 1.3862597942352295,
                        1.3088842630386353, 1.3123291730880737, 1.3267396688461304, 1.2858244180679321,
                        1.2087514400482178, 1.1690928936004639, 1.2299103736877441, 1.1226890087127686,
                        1.1252344846725464, 1.1602281332015991, 1.1046966314315796, 1.1017482280731201,
                        1.0725414752960205, 1.0744904279708862, 1.0797747373580933, 1.0784947872161865,
                        1.044872522354126, 1.0385301113128662, 1.0303919315338135, 1.0297740697860718,
                        1.0433354377746582, 1.076277732849121, 1.0684418678283691, 1.043026089668274,
                        1.0274161100387573, 1.0125826597213745, 1.0490282773971558, 1.0963765382766724,
                        1.074249267578125, 1.0045247077941895, 1.1243057250976562, 1.0447486639022827,
                        1.0278773307800293, 1.0444059371948242, 1.0813393592834473, 1.0745346546173096,
                        1.0955419540405273, 1.093396782875061],
           'val_accuracy': [0.2594427168369293, 0.2594427168369293, 0.2594427168369293, 0.30030959844589233,
                            0.2715170383453369, 0.415170282125473, 0.4659442603588104, 0.4674922525882721,
                            0.49226006865501404, 0.501857578754425, 0.4990712106227875, 0.5055727362632751,
                            0.5377709269523621, 0.5662538409233093, 0.5318885445594788, 0.5863776803016663,
                            0.5736842155456543, 0.5588235259056091, 0.5780185461044312, 0.5879256725311279,
                            0.6040247678756714, 0.603715181350708, 0.5975232124328613, 0.5975232124328613,
                            0.6198142170906067, 0.6315789222717285, 0.6154798865318298, 0.6226006150245667,
                            0.630340576171875, 0.6114550828933716, 0.6133127212524414, 0.6309597492218018,
                            0.6467491984367371, 0.638390064239502, 0.6318885684013367, 0.6108359098434448,
                            0.6247677803039551, 0.6513931751251221, 0.6213622093200684, 0.6455108523368835,
                            0.649535596370697, 0.6501547694206238, 0.6526315808296204, 0.6529411673545837,
                            0.6513931751251221, 0.6575851440429688],
           'lr': [0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001,
                  0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.00090000004, 0.00090000004,
                  0.00090000004, 0.00090000004, 0.00090000004, 0.00090000004, 0.00090000004, 0.00081000006,
                  0.00081000006, 0.00081000006, 0.00081000006, 0.00081000006, 0.00081000006, 0.0007290001, 0.0007290001,
                  0.0007290001, 0.0007290001, 0.00065610005, 0.00065610005, 0.00065610005, 0.00059049006,
                  0.00059049006]}

plota_historico_modelo(history)

